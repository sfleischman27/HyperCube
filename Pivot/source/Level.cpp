//
//  Level.cpp
//	Platformer
// 
//  Contains methods for retreving information about a level loaded from memory
//
//  Created by Jack on 2/23/23.
//

#include "Level.h"
#include <cugl/cugl.h>
#include <vector>


std::vector<Poly2> Level::GetMapCut(Vec3 origin, Vec3 normal) {

	// This is hardcoded for now

	std::vector<std::vector<float>> floats{
		//{ -1.0, -1.0, 1.0, 1.0, -1.0, 1.0, 1.0, -1.0},
		{ 4.19471969388 , 5.42813686028 , 4.81734658397 , 5.48766429318 , 9.72278868663 , 6.58114453004 , 10.4616004429 , 6.80224840071 , 14.4629826834 , 8.59169458452 , 14.6160718216 , 8.66519137050 , 16.9837647709 , 10.5548287584 , 17.0508109672 , 12.0914771764 , 13.9383844307 , 12.9058370368 , 13.9212113162 , 12.9098432852 , 9.28420596654 , 12.9360380329 , 7.28485797051 , 13.0047177633 , 4.75389235463 , 12.8889723106 , 0.300518495487 , 13.0649200885 , -4.11699169386 , 13.7463314595 , -4.69345992829 , 13.8913585845 , -8.56993383432 , 14.7605397287 , -13.0941962177 , 16.1109577455 , -17.7212841755 , 17.6661273108 , -22.4168373177 , 19.2784227251 , -26.9061351590 , 20.8066515808 , -30.8639121116 , 22.1059123073 , -33.9757238908 , 23.0285065676 , -36.0176716551 , 23.4909357986 , -36.0408928882 , 23.4947081252 , -37.0938799347 , 23.6701363675 , -37.3278845528 , 23.7896474301 , -36.8888800193 , 24.0709984582 , -35.9331266147 , 24.6739314176 , -34.5768158779 , 25.4924450717 , -32.9263587677 , 26.3536099505 , -31.0879338063 , 27.0841232573 , -29.1558135004 , 27.5480681676 , -27.1768488445 , 27.7594218283 , -25.1859756264 , 27.7695818259 , -23.2178686843 , 27.6297364871 , -21.3278350765 , 27.4137614914 , -19.6539458063 , 27.2864206160 , -18.3459506598 , 27.4016365288 , -17.5551725160 , 27.7169844402 , -16.7745441745 , 28.6237548112 , -16.7241985472 , 28.7179340254 , -16.3426966035 , 30.5255984935 , -16.3426966035 , 30.6495053826 , -16.7241985472 , 32.7646023667 , -16.7745441745 , 32.8994763431 , -17.5551725160 , 34.4379712494 , -18.3477462600 , 35.4096040930 , -19.6683171063 , 36.5536547036 , -21.3763444431 , 37.5949842412 , -23.3328558758 , 38.470226009 , -25.3890406465 , 39.1575435465 , -27.3927756266 , 39.6788603291 , -29.1910743971 , 40.0670819817 , -30.6308016918 , 40.3552746134 , -31.5547012404 , 40.5794349240 , -31.7910911943 , 40.7884144319 , -31.1679927186 , 41.0373987125 , -29.5057883618 , 41.3824627165 , -26.6918542906 , 41.8622446263 , -22.9812860677 , 42.4596090270 , -18.7475921207 , 43.1403640782 , -14.3875276062 , 43.8729273405 , -10.6305269869 , 44.4857740962 , -10.2032207780 , 44.5651611601 , -5.86406712613 , 45.0301269208 , -3.21434980612 , 44.8537208356 , -0.832162712403 , 44.8920251604 , 1.22276377612 , 44.6283996142 , 4.40122792146 , 44.7619922165 , 6.12269929698 , 45.4685902546 , 6.43942057035 , 45.6088364240 , 7.24895092554 , 47.0497222375 , 7.18378609551 , 48.3011980021 , 7.05354758177 , 48.8806453767 , 5.33387243240 , 50.7525453504 , 2.44125964213 , 52.3459973212 , 2.19388997569 , 52.4240524912 , -2.98691065484 , 52.7842104219 , -8.23229306419 , 52.3460039230 , -14.0284930118 , 51.8015909633 , -20.5888973330 , 51.6515418160 , -24.9215975573 , 51.7670965491 , -27.5162035963 , 51.7503948256 , -34.2484144833 , 51.6856078141 , -40.2893993454 , 51.3386605632 , -45.3014618929 , 50.4371477076 , -49.5500665482 , 49.1514465966 , -49.6363318684 , 49.1228604705 , -53.8155734946 , 47.6629480378 , -58.3645153326 , 46.4427694851 , -63.5911856229 , 45.6171550648 , -68.9452086890 , 44.8992136907 , -73.6617797385 , 43.8904824521 , -76.9760939789 , 42.1924984386 , -78.3508755055 , 39.5400379893 , -78.1589639647 , 36.2008344429 , -77.0007278908 , 32.5758603879 , -75.4765358180 , 29.0660884128 , -74.0481128276 , 26.0079692727 , -72.6226101892 , 23.4798663882 , -70.9685357192 , 21.4956213466 , -68.8543972342 , 20.0690757349 , -66.1274480762 , 19.1879499736 , -62.9499236896 , 18.7354798160 , -59.5628050441 , 18.5687798486 , -56.2070731096 , 18.5449646579 , -53.0358810964 , 18.5236545354 , -49.8511069650 , 18.3744602498 , -46.3666480752 , 17.9690806743 , -42.2960485459 , 17.1769697260 , -37.4496975711 , 15.9103163993 , -32.0267982831 , 14.2706070123 , -26.3263395121 , 12.4117012125 , -20.6464330151 , 10.4904706028 , -15.2233079916 , 8.66418512181 , -10.0494581606 , 7.08891942463 , -5.04537374947 , 5.93075992875 , -0.117723589701 , 5.35363472608 , 4.19471969388 , 5.42813686028 },
		{ 0.497712782445 , -7.95344173315 , -1.19148582756 , -7.72675799008 , -2.68008490366 , -8.31709159788 , -3.76656822943 , -9.50220404744 , -4.26413709650 , -11.0497900168 , -4.25330829772 , -11.1282891769 , -4.08578205016 , -13.3062588553 , -3.94298797753 , -13.7444158131 , -3.70484341359 , -15.5209770543 , -3.73754793797 , -16.9938551817 , -3.75548210601 , -17.1563791032 , -3.80040645981 , -18.3255165722 , -4.24910677197 , -19.5308172310 , -5.48504866904 , -20.5611793595 , -7.88634214015 , -21.3527592266 , -11.6431645939 , -21.8771482687 , -16.4627849307 , -22.1861001401 , -21.9470308999 , -22.3428725314 , -27.7118757508 , -22.4100342820 , -33.3705977763 , -22.4633074761 , -38.4855804022 , -22.6212171784 , -42.6487478344 , -23.0038022684 , -45.6827722536 , -23.7084370437 , -47.6185102256 , -24.8344817799 , -48.4015575768 , -26.2517022375 , -47.9680858536 , -27.5392923305 , -47.8771541083 , -27.7035948807 , -45.8615094411 , -28.8737380764 , -42.7122574904 , -29.6022019612 , -38.4244266943 , -29.9711529307 , -33.1022521947 , -30.0789320640 , -27.0677326394 , -30.0311085046 , -20.6586641218 , -29.9224020063 , -14.0400630752 , -29.7839085632 , -13.5000620139 , -29.7714052136 , -7.21125152117 , -29.3096099566 , -4.51939852799 , -28.9850166111 , 0.183176359084 , -27.8351917696 , 1.67035245643 , -27.1877303591 , 2.45257957383 , -26.2989544173 , 3.92231558949 , -24.3141607884 , 3.94184459227 , -23.1773561877 , 3.92951035157 , -20.9161211838 , 3.88926869938 , -19.2058463060 , 3.86750696279 , -18.8867815481 , 3.87806890276 , -18.4457590691 , 3.88657733999 , -16.7823636618 , 3.86441006738 , -14.5334832156 , 3.64072281572 , -12.4642166161 , 3.57550113559 , -12.0621036213 , 2.22225763272 , -9.16645605832 , 2.15822067109 , -9.08653264365 , 0.497712782445 , -7.95344173315 },
		{ -46.5885325819 , 27.4454087754 , -48.5462269984 , 26.9092680542 , -50.7383979745 , 26.6341044801 , -53.0943306972 , 26.5327510973 , -55.5439060709 , 26.5182733183 , -58.0068646679 , 26.5299103507 , -60.3617619201 , 26.6113632104 , -62.4768564413 , 26.8324483613 , -64.2204068452 , 27.2629822673 , -65.5055679841 , 27.9538452093 , -66.4250796626 , 28.8801727363 , -67.1165779240 , 29.9981642137 , -67.7176988111 , 31.2640190075 , -68.2964384754 , 32.6209286480 , -68.6422335013 , 33.9600533246 , -68.4748805816 , 35.1595453918 , -67.5141764091 , 36.0975572036 , -65.5862293886 , 36.6885242793 , -62.9423947728 , 36.9920147986 , -59.9403395265 , 37.1038801060 , -56.9377306145 , 37.1199715461 , -54.2035200124 , 37.1122417953 , -51.6518043625 , 37.0570488425 , -49.1081531615 , 36.9068436687 , -46.3988365105 , 36.6140402098 , -43.4502460652 , 36.1496263777 , -40.5886233020 , 35.5589566894 , -38.2403623739 , 34.9059508186 , -36.8326977312 , 34.2543167405 , -36.6571652180 , 33.6450962108 , -37.4615918699 , 33.0290103954 , -38.8579738081 , 32.3341802630 , -40.4587024308 , 31.4885367915 , -41.9611549873 , 30.4557241152 , -43.4022638793 , 29.3424693821 , -44.9039496506 , 28.2913708629 , -46.5885325819 , 27.4454087754 },
		{ 12.1343961148 , -44.0994567754 , 11.1861179758 , -40.7171750035 , 8.42581717615 , -37.7839169039 , 4.47303285803 , -35.8853497471 , -0.123065176062 , -34.9078934166 , -4.70647511973 , -34.6786730900 , -6.72949413888 , -35.0694124278 , -8.54976736972 , -34.9737397561 , -11.0239850774 , -36.1352270737 , -11.9166834528 , -38.9173671500 , -11.3325972830 , -41.7487373936 , -11.0218846600 , -43.2141361932 , -8.55185937804 , -48.1819688847 , -4.90707955203 , -52.7630666031 , -4.12470775015 , -53.2216784547 , -0.553988208581 , -54.7890648339 , 4.16718494554 , -53.2133069995 , 4.86751224000 , -52.7187942343 , 8.22850681689 , -50.2826949419 , 11.0475722905 , -47.2389689482 , 12.1343961148 , -44.0994567754 },
		{ -9.64031119096 , 36.5234004712 , -9.29970412552 , 35.0150142956 , -8.10356889558 , 33.6691323926 , -5.94191341757 , 32.6179247940 , -5.17291498049 , 32.4866956031 , -2.25206311305 , 31.8835108145 , -1.56140168315 , 31.9107330163 , 3.69204350691 , 31.3617438892 , 5.34597676654 , 31.0157131905 , 8.09421460004 , 30.8186558722 , 10.6205821635 , 30.3658532542 , 13.0751691102 , 30.3321206911 , 14.9791959635 , 30.1452190547 , 17.3176846032 , 30.8099397672 , 16.7708041805 , 32.5847212401 , 15.0012415005 , 34.1242324218 , 14.1358962449 , 34.9611902609 , 10.0486693747 , 37.4870207133 , 9.97762175172 , 37.5190859271 , 5.07282190220 , 39.4837114928 , 3.55635571197 , 39.8994935525 , -0.364121648508 , 40.6389189566 , -1.36835932006 , 40.8164659583 , -5.52145369768 , 40.4687036270 , -7.78743230792 , 39.4239976655 , -9.13947999815 , 38.0476669582 , -9.64031119096 , 36.5234004712 },
	};

	std::vector<cugl::Poly2> polygons;
	auto extruder = new SimpleExtruder();

	float scale = 0.01;

	for (int i = 0; i < floats.size(); i++) {
		std::vector<Vec2> verts;
		for (int j = 0; j < floats[i].size(); j = j + 2) {
			verts.push_back(Vec2(floats[i][j], floats[i][j + 1])*scale);
		}
		float width = .01;
		auto path = cugl::Path2(verts);

		extruder->set(path);
		extruder->calculate(width);
		polygons.push_back(extruder->getPolygon());
	
	}
	CULog(std::to_string(polygons.size()).c_str());
	
	return polygons;


};