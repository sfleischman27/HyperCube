# PROJECT CMAKE FILE
# This file is autogenerated by the creator script
cmake_minimum_required(VERSION 3.10)

# set the project name and version
project(sdl2codec VERSION 1.0)

# Get the directories
set(SDL2_PCKG_DIR  "${PROJECT_SOURCE_DIR}/../../..")
set(SDL2_CODEC_DIR  "${SDL2_PCKG_DIR}/extensions/codec")

# Add the includes
list(APPEND EXTRA_INCLUDES "${SDL2_CODEC_DIR}/ogg/include")
list(APPEND EXTRA_INCLUDES "${SDL2_CODEC_DIR}/vorbis/include")
list(APPEND EXTRA_INCLUDES "${SDL2_CODEC_DIR}/flac/include")
list(APPEND EXTRA_INCLUDES "${SDL2_CODEC_DIR}/mpeg/include")
list(APPEND EXTRA_INCLUDES "${SDL2_PCKG_DIR}/include")

# MSVC is the worst
if (MSVC)
    add_compile_options(/wd4068)
    add_compile_options(/wd4018)
    add_compile_options(/wd4244)
    add_compile_options(/wd4305)
    add_compile_options(/wd4800)
    add_compile_options(/wd4267)
    add_compile_options(/wd26812)
    add_compile_options(/wd26495)
endif()

# Compile the interface (we only support static for now)
set(CODEC_SOURCES
    ${SDL2_CODEC_DIR}/CODEC_common.c
    ${SDL2_CODEC_DIR}/CODEC_vorbis.c
    ${SDL2_CODEC_DIR}/CODEC_flac.c
    ${SDL2_CODEC_DIR}/CODEC_mpeg.c
    ${SDL2_CODEC_DIR}/CODEC_wav.c
)

add_library(SDL2_codec ${CODEC_SOURCES})
add_library(SDL2_codec::SDL2_codec-static ALIAS SDL2_codec)

# Add the libraries
add_subdirectory("${SDL2_CODEC_DIR}/ogg" "ogg.dir")
list(APPEND EXTRA_LIBS ogg)

add_subdirectory("${SDL2_CODEC_DIR}/vorbis" "vorbis.dir")
list(APPEND EXTRA_LIBS vorbis)
list(APPEND EXTRA_LIBS vorbisenc)
list(APPEND EXTRA_LIBS vorbisfile)

add_subdirectory("${SDL2_CODEC_DIR}/flac" "flac.dir")
list(APPEND EXTRA_LIBS FLAC)

add_subdirectory("${SDL2_CODEC_DIR}/minimp3" "minimp3.dir")
list(APPEND EXTRA_LIBS minimp3::minimp3-static)

target_link_libraries(SDL2_codec ${EXTRA_LIBS})
target_include_directories(SDL2_codec PUBLIC
                           "${PROJECT_BINARY_DIR}"
                            ${EXTRA_INCLUDES}
                           )
