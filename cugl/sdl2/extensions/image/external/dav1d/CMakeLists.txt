# PROJECT CMAKE FILE
# This file is autogenerated by the creator script
cmake_minimum_required(VERSION 3.10)

# set the project name and version
project(dav1d VERSION 1.0)

# Set C99 as the default
set(CMAKE_C_STANDARD 99)

# Add the includes
list(APPEND EXTRA_INCLUDES "${PROJECT_SOURCE_DIR}")
list(APPEND EXTRA_INCLUDES "${PROJECT_SOURCE_DIR}/include")
list(APPEND EXTRA_INCLUDES "${PROJECT_SOURCE_DIR}/arch")
if (MSVC)
list(APPEND EXTRA_INCLUDES "${PROJECT_SOURCE_DIR}/arch/x86_64")
else()
    list(APPEND EXTRA_INCLUDES "${PROJECT_SOURCE_DIR}/arch/${CMAKE_HOST_SYSTEM_PROCESSOR}")
endif()

# Compile the source (we only support static for now)
set(DAV1D_SOURCES
    src/cdf.c
    src/cpu.c
    src/data.c
    src/decode.c
    src/dequant_tables.c
    src/getbits.c
    src/intra_edge.c
    src/itx_1d.c
    src/lf_mask.c
    src/lib.c
    src/log.c
    src/mem.c
    src/msac.c
    src/obu.c
    src/picture.c
    src/qm.c
    src/ref.c
    src/refmvs.c
    src/scan.c
    src/tables.c
    src/thread_task.c
    src/warpmv.c
    src/wedge.c
    src/cdef_apply_tmpl.c
    src/cdef_tmpl.c
    src/fg_apply_tmpl.c
    src/filmgrain_tmpl.c
    src/ipred_prepare_tmpl.c
    src/ipred_tmpl.c
    src/itx_tmpl.c
    src/lf_apply_tmpl.c
    src/loopfilter_tmpl.c
    src/looprestoration_tmpl.c
    src/lr_apply_tmpl.c
    src/mc_tmpl.c
    src/recon_tmpl.c
)

add_definitions(-DBITDEPTH=16)
if (MSVC)
else()
    set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wno-incompatible-pointer-types -Wno-stringop-overflow")
endif()
add_library(dav1d STATIC ${DAV1D_SOURCES})
target_include_directories(dav1d PUBLIC
                           "${PROJECT_BINARY_DIR}"
                            ${EXTRA_INCLUDES}
                           )
